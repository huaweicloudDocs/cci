# 容器健康检查<a name="cci_01_0013"></a>

健康检查是指容器运行过程中，根据需要，定时检查容器健康状况。

云容器实例基于Kubernetes，提供了两种健康检查的方式：

-   ****应用存活探针（liveness probe），探测应用是否已经启动**：**该检查方式用于检测容器是否存活，类似于我们执行 ps 命令检查进程是否存在。如果容器的存活检查失败，集群会对该容器执行重启操作；若容器的存活检查成功则不执行任何操作。
-   ****应用业务探针（readiness probe），探测应用业务是否已经就绪**：**该检查方式用于检测容器是否准备好开始处理用户请求。一些程序的启动时间可能很长，比如要加载磁盘数据或者要依赖外部的某个模块启动完成才能提供服务。这时候程序进程在，但是并不能对外提供服务。这种场景下该检查方式就非常有用。

## 健康检查方式<a name="section12951539165819"></a>

-   **HTTP GET 请求**

    探针往容器发送HTTP GET请求，如果探针收到2xx或3xx的返回状态码，说明容器是健康。

-   **命令行脚本**

    探针执行容器中的命令并检查命令退出的状态码，如果状态码为0则说明健康。

    例如，您若希望配置检测应用是否成功创建目录foo的探针，那么需要在界面上做如下配置：

    ```
    if [ ! -d "foo"]; then
    exit  1 
    else  
    exit  0 
    fi 
    ```


## 公共参数说明<a name="section18602011747"></a>

**表 1**  健康检查参数说明

<a name="zh-cn_topic_0052519475_table548283811358"></a>
<table><thead align="left"><tr id="zh-cn_topic_0052519475_row1948333883520"><th class="cellrowborder" valign="top" width="27%" id="mcps1.2.3.1.1"><p id="zh-cn_topic_0052519475_p17483038163512"><a name="zh-cn_topic_0052519475_p17483038163512"></a><a name="zh-cn_topic_0052519475_p17483038163512"></a>参数</p>
</th>
<th class="cellrowborder" valign="top" width="73%" id="mcps1.2.3.1.2"><p id="zh-cn_topic_0052519475_p74835383351"><a name="zh-cn_topic_0052519475_p74835383351"></a><a name="zh-cn_topic_0052519475_p74835383351"></a>参数说明</p>
</th>
</tr>
</thead>
<tbody><tr id="zh-cn_topic_0052519475_row174831338113511"><td class="cellrowborder" valign="top" width="27%" headers="mcps1.2.3.1.1 "><p id="p183641821163711"><a name="p183641821163711"></a><a name="p183641821163711"></a>延迟探测时间</p>
</td>
<td class="cellrowborder" valign="top" width="73%" headers="mcps1.2.3.1.2 "><p id="zh-cn_topic_0052519475_p05855219373"><a name="zh-cn_topic_0052519475_p05855219373"></a><a name="zh-cn_topic_0052519475_p05855219373"></a>延迟探测时间，单位为秒。例如，设置为10，表示从容器启动后10秒开始探测。</p>
</td>
</tr>
<tr id="zh-cn_topic_0052519475_row94831338173514"><td class="cellrowborder" valign="top" width="27%" headers="mcps1.2.3.1.1 "><p id="p36325348374"><a name="p36325348374"></a><a name="p36325348374"></a>超时时间</p>
</td>
<td class="cellrowborder" valign="top" width="73%" headers="mcps1.2.3.1.2 "><p id="zh-cn_topic_0052519475_p1322592833713"><a name="zh-cn_topic_0052519475_p1322592833713"></a><a name="zh-cn_topic_0052519475_p1322592833713"></a>超时时间，单位为秒。例如，设置为10，表明执行健康检查的超时等待时间为10秒，如果超过这个时间，本次健康检查就被视为失败。若设置为0或不设置，默认超时等待时间为1秒。</p>
</td>
</tr>
</tbody>
</table>

